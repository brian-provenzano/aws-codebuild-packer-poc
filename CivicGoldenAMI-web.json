{
  "_comment": "Create simple image ",
  "variables": {
    "aws_access_key": "",
    "aws_secret_key": "",
    "aws_region": "",
    "aws_instance_type": "",
    "aws_aminame": "",
    "aws_imageid": "",
    "aws_instanceprofile": ""
  },
  "builders": [{
    "type": "amazon-ebs",
    "region": "{{user `aws_region`}}",
    "access_key": "{{user `aws_access_key`}}",
    "secret_key": "{{user `aws_secret_key`}}",
    "source_ami" : "{{user `aws_imageid`}}",
    "iam_instance_profile": "{{user `aws_instanceprofile`}}",
    "instance_type": "{{user `aws_instance_type`}}",
    "ssh_username": "ec2-user",
    "ami_name": "{{user `aws_aminame`}}-AMZNLinux1-{{timestamp}}",
    "ami_description": "LGFCU - Civic Web server : AmazonLinux : php71, nodejs, npm, drush, composer",
      "tags": {
        "Name": "{{user `aws_aminame`}}-AMZNLinux1",
        "OS_Version": "amazonlinux1",
        "Applications": "nodejs,npm,php,gulp,composer,drush",
        "NodeJSVersion": "10.x",
        "Purpose": "web",
        "BuildDate": "{{timestamp}}"
  }
  }],
  "provisioners": [
    {
      "type": "shell",
      "execute_command": "chmod +x {{ .Path }}; {{ .Vars }} sudo '{{ .Path }}'",
      "script": "deploy-bootstrap.sh"
    }
  ]
}